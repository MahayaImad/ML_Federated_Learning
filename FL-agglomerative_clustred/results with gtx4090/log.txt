Mode: compare
Configuration: 50 clients, 100 rounds
Data distribution: Non-IID
Using GPU: /physical_device:GPU:0

Preparing data...
Préparation des données CIFAR-10 (Non-IID)

CIFAR-10 Data Distribution
--------------------------------------------------
Client 0: 1000 samples
  Top classes: [6 1 4] ([424 252 143])
Client 1: 1000 samples
  Top classes: [8 5 1] ([347 230 128])
Client 2: 1000 samples
  Top classes: [1 9 6] ([415 163 102])
Client 3: 1000 samples
  Top classes: [3 7 0] ([340 188 166])
Client 4: 1000 samples
  Top classes: [8 1 2] ([322 301 140])
Client 5: 1000 samples
  Top classes: [0 4 7] ([405 228 133])
Client 6: 1000 samples
  Top classes: [0 7 1] ([423 128 124])
Client 7: 1000 samples
  Top classes: [3 2 6] ([540 208 112])
Client 8: 1000 samples
  Top classes: [4 0 9] ([702  87  81])
Client 9: 1000 samples
  Top classes: [7 5 0] ([363 301 129])
Client 10: 1000 samples
  Top classes: [4 8 3] ([387 164 143])
Client 11: 1000 samples
  Top classes: [0 1 2] ([384 237 145])
Client 12: 1000 samples
  Top classes: [2 4 5] ([426 294 167])
Client 13: 1000 samples
  Top classes: [8 9 6] ([368 336  78])
Client 14: 1000 samples
  Top classes: [3 4 5] ([306 207 199])
Client 15: 1000 samples
  Top classes: [0 7 4] ([266 200 190])
Client 16: 1000 samples
  Top classes: [1 5 7] ([367 352 122])
Client 17: 1000 samples
  Top classes: [8 9 0] ([351 255 161])
Client 18: 1000 samples
  Top classes: [3 6 4] ([466 266 145])
Client 19: 1000 samples
  Top classes: [6 2 8] ([455 205 106])
Client 20: 1000 samples
  Top classes: [5 6 3] ([356 262  94])
Client 21: 1000 samples
  Top classes: [7 6 9] ([504 244  78])
Client 22: 1000 samples
  Top classes: [1 3 9] ([324 246 124])
Client 23: 1000 samples
  Top classes: [0 1 7] ([294 176 159])
Client 24: 1000 samples
  Top classes: [7 8 1] ([240 234 154])
Client 25: 1000 samples
  Top classes: [3 6 7] ([487 168 150])
Client 26: 1000 samples
  Top classes: [0 7 4] ([442 136 105])
Client 27: 1000 samples
  Top classes: [0 3 1] ([504 116 105])
Client 28: 1000 samples
  Top classes: [9 0 4] ([276 225 166])
Client 29: 1000 samples
  Top classes: [0 8 9] ([535 115 113])
Client 30: 1000 samples
  Top classes: [2 7 8] ([662  86  66])
Client 31: 1000 samples
  Top classes: [4 3 8] ([440 160 143])
Client 32: 1000 samples
  Top classes: [1 6 8] ([347 177 108])
Client 33: 1000 samples
  Top classes: [4 9 3] ([239 216 209])
Client 34: 1000 samples
  Top classes: [9 8 6] ([317 189 141])
Client 35: 1000 samples
  Top classes: [8 1 2] ([309 245 149])
Client 36: 1000 samples
  Top classes: [5 8 7] ([236 179 162])
Client 37: 1000 samples
  Top classes: [4 8 5] ([304 135 114])
Client 38: 1000 samples
  Top classes: [7 2 1] ([495 216  87])
Client 39: 1000 samples
  Top classes: [6 7 3] ([406 242 175])
Client 40: 1000 samples
  Top classes: [9 3 7] ([597 114 103])
Client 41: 1000 samples
  Top classes: [8 4 3] ([204 182 182])
Client 42: 1000 samples
  Top classes: [4 6 9] ([295 245 167])
Client 43: 1000 samples
  Top classes: [7 6 5] ([287 197 152])
Client 44: 1000 samples
  Top classes: [8 2 9] ([246 204 192])
Client 45: 1000 samples
  Top classes: [8 6 4] ([245 131 130])
Client 46: 1000 samples
  Top classes: [5 9 7] ([495 215  75])
Client 47: 1000 samples
  Top classes: [2 9 5] ([280 244 236])
Client 48: 1000 samples
  Top classes: [2 5 9] ([285 257 206])
Client 49: 1000 samples
  Top classes: [2 5 9] ([392 348 176])
--------------------------------------------------
Setup complete: 50 clients, 10000 test samples

============================================================
Comparing all FL methods...
============================================================

============================================================
Training: VANILLA
============================================================
 Train of Vanilla FL (FedAvg)...
I0000 00:00:1760225905.323838   91525 gpu_device.cc:2019] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 13153 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:03:00.0, compute capability: 8.9
  Round 1/100
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1760225908.266729   93267 service.cc:152] XLA service 0x7f3a4000c9b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
I0000 00:00:1760225908.266747   93267 service.cc:160]   StreamExecutor device (0): NVIDIA GeForce RTX 4090, Compute Capability 8.9
I0000 00:00:1760225908.646258   93267 cuda_dnn.cc:529] Loaded cuDNN version 90300
I0000 00:00:1760225913.341267   93267 device_compiler.h:188] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
    Accuracy: 0.0986, Comm Cost: 100, Time: 472.99s
  Round 2/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.84s
  Round 3/100
    Accuracy: 0.1323, Comm Cost: 100, Time: 51.67s
  Round 4/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.71s
  Round 5/100
    Accuracy: 0.1002, Comm Cost: 100, Time: 51.94s
  Round 6/100
    Accuracy: 0.0993, Comm Cost: 100, Time: 51.80s
  Round 7/100
    Accuracy: 0.0964, Comm Cost: 100, Time: 51.89s
  Round 8/100
    Accuracy: 0.0945, Comm Cost: 100, Time: 51.85s
  Round 9/100
    Accuracy: 0.0916, Comm Cost: 100, Time: 51.68s
  Round 10/100
    Accuracy: 0.0934, Comm Cost: 100, Time: 51.74s
  Round 11/100
    Accuracy: 0.0899, Comm Cost: 100, Time: 51.94s
  Round 12/100
    Accuracy: 0.0920, Comm Cost: 100, Time: 51.69s
  Round 13/100
    Accuracy: 0.0911, Comm Cost: 100, Time: 51.76s
  Round 14/100
    Accuracy: 0.0962, Comm Cost: 100, Time: 51.92s
  Round 15/100
    Accuracy: 0.0992, Comm Cost: 100, Time: 51.90s
  Round 16/100
    Accuracy: 0.0998, Comm Cost: 100, Time: 51.92s
  Round 17/100
    Accuracy: 0.0996, Comm Cost: 100, Time: 52.05s
  Round 18/100
    Accuracy: 0.0998, Comm Cost: 100, Time: 51.87s
  Round 19/100
    Accuracy: 0.1002, Comm Cost: 100, Time: 52.06s
  Round 20/100
    Accuracy: 0.1004, Comm Cost: 100, Time: 51.93s
  Round 21/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 52.02s
  Round 22/100
    Accuracy: 0.1004, Comm Cost: 100, Time: 52.10s
  Round 23/100
    Accuracy: 0.1004, Comm Cost: 100, Time: 52.15s
  Round 24/100
    Accuracy: 0.1002, Comm Cost: 100, Time: 51.96s
  Round 25/100
    Accuracy: 0.1002, Comm Cost: 100, Time: 52.16s
  Round 26/100
    Accuracy: 0.1001, Comm Cost: 100, Time: 52.07s
  Round 27/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 52.05s
  Round 28/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.77s
  Round 29/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.85s
  Round 30/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.81s
  Round 31/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.78s
  Round 32/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.82s
  Round 33/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.97s
  Round 34/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 54.97s
  Round 35/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 52.87s
  Round 36/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 52.70s
  Round 37/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 52.55s
  Round 38/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 52.48s
  Round 39/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 52.22s
  Round 40/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 52.23s
  Round 41/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.89s
  Round 42/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 52.15s
  Round 43/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.91s
  Round 44/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 52.14s
  Round 45/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.94s
  Round 46/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.98s
  Round 47/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.99s
  Round 48/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.95s
  Round 49/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.90s
  Round 50/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 52.01s
  Round 51/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.82s
  Round 52/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.66s
  Round 53/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.78s
  Round 54/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 52.01s
  Round 55/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.67s
  Round 56/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.88s
  Round 57/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.81s
  Round 58/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.89s
  Round 59/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.97s
  Round 60/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.83s
  Round 61/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.54s
  Round 62/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.79s
  Round 63/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.77s
  Round 64/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.87s
  Round 65/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.77s
  Round 66/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.61s
  Round 67/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.85s
  Round 68/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.93s
  Round 69/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.69s
  Round 70/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.71s
  Round 71/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.72s
  Round 72/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.69s
  Round 73/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.59s
  Round 74/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.69s
  Round 75/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.68s
  Round 76/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.70s
  Round 77/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.78s
  Round 78/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.88s
  Round 79/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.70s
  Round 80/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.57s
  Round 81/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.62s
  Round 82/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.84s
  Round 83/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.78s
  Round 84/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.67s
  Round 85/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.84s
  Round 86/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.84s
  Round 87/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.71s
  Round 88/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.74s
  Round 89/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.67s
  Round 90/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.83s
  Round 91/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.70s
  Round 92/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.68s
  Round 93/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.57s
  Round 94/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.74s
  Round 95/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.73s
  Round 96/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.72s
  Round 97/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.79s
  Round 98/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.67s
  Round 99/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.78s
  Round 100/100
    Accuracy: 0.1000, Comm Cost: 100, Time: 51.79s
Client statistics saved to: /FL-agglomerative_clustred/results/client_stats_cifar10_vanilla_20251012_011156.csv

Results saved to: results/25-10-12-01-12_cifar10_vanilla_50cl_5ep_100r.txt

Visualization saved to: visualizations/cifar10_vanilla_50cl_5ep_100r_25-10-12-01-12.png

============================================================
Training: HIERARCHICAL
============================================================
  Edge Server 0: 5 clients : [0, 1, 2, 3, 4]
  Edge Server 1: 5 clients : [5, 6, 7, 8, 9]
  Edge Server 2: 5 clients : [10, 11, 12, 13, 14]
  Edge Server 3: 5 clients : [15, 16, 17, 18, 19]
  Edge Server 4: 5 clients : [20, 21, 22, 23, 24]
  Edge Server 5: 5 clients : [25, 26, 27, 28, 29]
  Edge Server 6: 5 clients : [30, 31, 32, 33, 34]
  Edge Server 7: 5 clients : [35, 36, 37, 38, 39]
  Edge Server 8: 5 clients : [40, 41, 42, 43, 44]
  Edge Server 9: 5 clients : [45, 46, 47, 48, 49]
 Train of FL hierarchical...
Round 1/100
  Accuracy: 0.1000, Time: 479.26s, Comm: 120
Round 2/100
  Accuracy: 0.1000, Time: 52.18s, Comm: 120
Round 3/100
  Accuracy: 0.1000, Time: 52.08s, Comm: 120
Round 4/100
  Accuracy: 0.1000, Time: 52.08s, Comm: 120
Round 5/100
  Accuracy: 0.1000, Time: 52.10s, Comm: 120
Round 6/100
  Accuracy: 0.1000, Time: 52.22s, Comm: 120
Round 7/100
  Accuracy: 0.1064, Time: 52.30s, Comm: 120
Round 8/100
  Accuracy: 0.1668, Time: 52.20s, Comm: 120
Round 9/100
  Accuracy: 0.2835, Time: 52.52s, Comm: 120
Round 10/100
  Accuracy: 0.3432, Time: 52.08s, Comm: 120
Round 11/100
  Accuracy: 0.4165, Time: 52.21s, Comm: 120
Round 12/100
  Accuracy: 0.4650, Time: 52.14s, Comm: 120
Round 13/100
  Accuracy: 0.4777, Time: 52.18s, Comm: 120
Round 14/100
  Accuracy: 0.5142, Time: 52.37s, Comm: 120
Round 15/100
  Accuracy: 0.5107, Time: 52.39s, Comm: 120
Round 16/100
  Accuracy: 0.5433, Time: 52.33s, Comm: 120
Round 17/100
  Accuracy: 0.5486, Time: 52.38s, Comm: 120
Round 18/100
  Accuracy: 0.5811, Time: 52.24s, Comm: 120
Round 19/100
  Accuracy: 0.5798, Time: 52.41s, Comm: 120
Round 20/100
  Accuracy: 0.5972, Time: 52.35s, Comm: 120
Round 21/100
  Accuracy: 0.5925, Time: 52.29s, Comm: 120
Round 22/100
  Accuracy: 0.6008, Time: 52.22s, Comm: 120
Round 23/100
  Accuracy: 0.6052, Time: 52.31s, Comm: 120
Round 24/100
  Accuracy: 0.6144, Time: 52.32s, Comm: 120
Round 25/100
  Accuracy: 0.6333, Time: 52.30s, Comm: 120
Round 26/100
  Accuracy: 0.6222, Time: 52.25s, Comm: 120
Round 27/100
  Accuracy: 0.6328, Time: 52.32s, Comm: 120
Round 28/100
  Accuracy: 0.6341, Time: 52.24s, Comm: 120
Round 29/100
  Accuracy: 0.6309, Time: 52.33s, Comm: 120
Round 30/100
  Accuracy: 0.6362, Time: 52.51s, Comm: 120
Round 31/100
  Accuracy: 0.6403, Time: 52.43s, Comm: 120
Round 32/100
  Accuracy: 0.6399, Time: 52.28s, Comm: 120
Round 33/100
  Accuracy: 0.6454, Time: 52.42s, Comm: 120
Round 34/100
  Accuracy: 0.6407, Time: 52.39s, Comm: 120
Round 35/100
  Accuracy: 0.6529, Time: 52.37s, Comm: 120
Round 36/100
  Accuracy: 0.6554, Time: 52.41s, Comm: 120
Round 37/100
  Accuracy: 0.6578, Time: 52.40s, Comm: 120
Round 38/100
  Accuracy: 0.6563, Time: 52.43s, Comm: 120
Round 39/100
  Accuracy: 0.6635, Time: 52.42s, Comm: 120
Round 40/100
  Accuracy: 0.6568, Time: 52.41s, Comm: 120
Round 41/100
  Accuracy: 0.6645, Time: 52.57s, Comm: 120
Round 42/100
  Accuracy: 0.6671, Time: 52.50s, Comm: 120
Round 43/100
  Accuracy: 0.6660, Time: 52.56s, Comm: 120
Round 44/100
  Accuracy: 0.6750, Time: 52.42s, Comm: 120
Round 45/100
  Accuracy: 0.6644, Time: 52.43s, Comm: 120
Round 46/100
  Accuracy: 0.6729, Time: 52.32s, Comm: 120
Round 47/100
  Accuracy: 0.6600, Time: 52.41s, Comm: 120
Round 48/100
  Accuracy: 0.6774, Time: 52.33s, Comm: 120
Round 49/100
  Accuracy: 0.6755, Time: 52.15s, Comm: 120
Round 50/100
  Accuracy: 0.6758, Time: 52.52s, Comm: 120
Round 51/100
  Accuracy: 0.6770, Time: 52.29s, Comm: 120
Round 52/100
  Accuracy: 0.6763, Time: 52.33s, Comm: 120
Round 53/100
  Accuracy: 0.6759, Time: 52.41s, Comm: 120
Round 54/100
  Accuracy: 0.6737, Time: 52.42s, Comm: 120
Round 55/100
  Accuracy: 0.6780, Time: 52.51s, Comm: 120
Round 56/100
  Accuracy: 0.6812, Time: 52.47s, Comm: 120
Round 57/100
  Accuracy: 0.6778, Time: 52.44s, Comm: 120
Round 58/100
  Accuracy: 0.6755, Time: 52.31s, Comm: 120
Round 59/100
  Accuracy: 0.6739, Time: 52.43s, Comm: 120
Round 60/100
  Accuracy: 0.6768, Time: 52.32s, Comm: 120
Round 61/100
  Accuracy: 0.6737, Time: 52.36s, Comm: 120
Round 62/100
  Accuracy: 0.6759, Time: 52.29s, Comm: 120
Round 63/100
  Accuracy: 0.6757, Time: 52.41s, Comm: 120
Round 64/100
  Accuracy: 0.6791, Time: 52.45s, Comm: 120
Round 65/100
  Accuracy: 0.6812, Time: 52.24s, Comm: 120
Round 66/100
  Accuracy: 0.6737, Time: 52.25s, Comm: 120
Round 67/100
  Accuracy: 0.6746, Time: 52.15s, Comm: 120
Round 68/100
  Accuracy: 0.6730, Time: 52.49s, Comm: 120
Round 69/100
  Accuracy: 0.6736, Time: 52.38s, Comm: 120
Round 70/100
  Accuracy: 0.6761, Time: 52.36s, Comm: 120
Round 71/100
  Accuracy: 0.6710, Time: 52.57s, Comm: 120
Round 72/100
  Accuracy: 0.6754, Time: 52.39s, Comm: 120
Round 73/100
  Accuracy: 0.6719, Time: 52.43s, Comm: 120
Round 74/100
  Accuracy: 0.6759, Time: 52.32s, Comm: 120
Round 75/100
  Accuracy: 0.6742, Time: 52.38s, Comm: 120
Round 76/100
  Accuracy: 0.6772, Time: 52.16s, Comm: 120
Round 77/100
  Accuracy: 0.6743, Time: 52.33s, Comm: 120
Round 78/100
  Accuracy: 0.6783, Time: 52.37s, Comm: 120
Round 79/100
  Accuracy: 0.6743, Time: 52.37s, Comm: 120
Round 80/100
  Accuracy: 0.6712, Time: 52.42s, Comm: 120
Round 81/100
  Accuracy: 0.6710, Time: 52.16s, Comm: 120
Round 82/100
  Accuracy: 0.6700, Time: 52.37s, Comm: 120
Round 83/100
  Accuracy: 0.6662, Time: 52.46s, Comm: 120
Round 84/100
  Accuracy: 0.6684, Time: 52.39s, Comm: 120
Round 85/100
  Accuracy: 0.6685, Time: 52.37s, Comm: 120
Round 86/100
  Accuracy: 0.6728, Time: 52.27s, Comm: 120
Round 87/100
  Accuracy: 0.6748, Time: 52.29s, Comm: 120
Round 88/100
  Accuracy: 0.6729, Time: 52.50s, Comm: 120
Round 89/100
  Accuracy: 0.6743, Time: 52.33s, Comm: 120
Round 90/100
  Accuracy: 0.6720, Time: 52.39s, Comm: 120
Round 91/100
  Accuracy: 0.6744, Time: 52.27s, Comm: 120
Round 92/100
  Accuracy: 0.6727, Time: 52.43s, Comm: 120
Round 93/100
  Accuracy: 0.6702, Time: 52.56s, Comm: 120
Round 94/100
  Accuracy: 0.6696, Time: 52.28s, Comm: 120
Round 95/100
  Accuracy: 0.6680, Time: 52.31s, Comm: 120
Round 96/100
  Accuracy: 0.6686, Time: 52.48s, Comm: 120
Round 97/100
  Accuracy: 0.6595, Time: 52.36s, Comm: 120
Round 98/100
  Accuracy: 0.6814, Time: 52.47s, Comm: 120
Round 99/100
  Accuracy: 0.6817, Time: 52.36s, Comm: 120
Round 100/100
  Accuracy: 0.6843, Time: 52.42s, Comm: 120
Client statistics saved to: /FL-agglomerative_clustred/results/client_stats_cifar10_hierarchical_20251012_024716.csv

Results saved to: results/25-10-12-02-48_cifar10_hierarchical_50cl_5ep_100r.txt

Visualization saved to: visualizations/cifar10_hierarchical_50cl_5ep_100r_25-10-12-02-48.png

============================================================
Training: DROP_IN
============================================================
  Edge 0: 8 clients (with duplicates) : [0, 1, 2, 3, 4, 43, 29, 30]
  Edge 1: 8 clients (with duplicates) : [5, 6, 7, 8, 9, 1, 39, 14]
  Edge 2: 8 clients (with duplicates) : [10, 11, 12, 13, 14, 31, 1, 20]
  Edge 3: 8 clients (with duplicates) : [15, 16, 17, 18, 19, 32, 36, 8]
  Edge 4: 8 clients (with duplicates) : [20, 21, 22, 23, 24, 18, 42, 33]
  Edge 5: 8 clients (with duplicates) : [25, 26, 27, 28, 29, 12, 31, 17]
  Edge 6: 8 clients (with duplicates) : [30, 31, 32, 33, 34, 36, 41, 40]
  Edge 7: 8 clients (with duplicates) : [35, 36, 37, 38, 39, 29, 6, 42]
  Edge 8: 8 clients (with duplicates) : [40, 41, 42, 43, 44, 31, 32, 3]
  Edge 9: 8 clients (with duplicates) : [45, 46, 47, 48, 49, 16, 15, 32]
 Train of FL drop-in...
Accuracy: 0.1000, Time: 500.59s, Comm: 180
Round 2/100
  Accuracy: 0.1000, Time: 81.91s, Comm: 180
Round 3/100
  Accuracy: 0.1000, Time: 82.26s, Comm: 180
Round 4/100
  Accuracy: 0.1031, Time: 82.36s, Comm: 180
Round 6/100
  Accuracy: 0.1000, Time: 82.33s, Comm: 180
Round 7/100
  Accuracy: 0.1001, Time: 82.22s, Comm: 180
Round 8/100
  Accuracy: 0.1033, Time: 82.36s, Comm: 180
Round 9/100
  Accuracy: 0.1404, Time: 82.30s, Comm: 180
Round 10/100
  Accuracy: 0.1800, Time: 82.32s, Comm: 180
Round 11/100
  Accuracy: 0.3003, Time: 82.33s, Comm: 180
Round 12/100
  Accuracy: 0.3139, Time: 82.67s, Comm: 180
Round 13/100
  Accuracy: 0.3459, Time: 82.65s, Comm: 180
Round 14/100
  Accuracy: 0.3882, Time: 82.33s, Comm: 180
Round 15/100
  Accuracy: 0.4214, Time: 82.43s, Comm: 180
Round 16/100
  Accuracy: 0.4250, Time: 82.43s, Comm: 180
Round 17/100
  Accuracy: 0.4528, Time: 82.47s, Comm: 180
Round 18/100
  Accuracy: 0.4784, Time: 82.59s, Comm: 180
Round 19/100
  Accuracy: 0.4980, Time: 82.54s, Comm: 180
Round 20/100
  Accuracy: 0.5139, Time: 85.05s, Comm: 180
Round 21/100
  Accuracy: 0.5250, Time: 83.82s, Comm: 180
Round 22/100
  Accuracy: 0.5321, Time: 83.64s, Comm: 180
Round 23/100
  Accuracy: 0.5348, Time: 83.48s, Comm: 180
Round 24/100
  Accuracy: 0.5433, Time: 82.95s, Comm: 180
Round 25/100
  Accuracy: 0.5373, Time: 82.76s, Comm: 180
Round 26/100
  Accuracy: 0.5565, Time: 82.87s, Comm: 180
Round 27/100
  Accuracy: 0.5698, Time: 82.73s, Comm: 180
Round 28/100
  Accuracy: 0.5772, Time: 82.80s, Comm: 180
Round 29/100
  Accuracy: 0.5821, Time: 82.90s, Comm: 180
Round 30/100
  Accuracy: 0.5847, Time: 82.84s, Comm: 180
Round 31/100
  Accuracy: 0.5868, Time: 82.84s, Comm: 180
Round 32/100
  Accuracy: 0.5843, Time: 82.82s, Comm: 180
Round 33/100
  Accuracy: 0.6077, Time: 82.71s, Comm: 180
Round 34/100
  Accuracy: 0.6125, Time: 82.77s, Comm: 180
Round 35/100
  Accuracy: 0.6209, Time: 82.74s, Comm: 180
Round 36/100
  Accuracy: 0.6237, Time: 82.70s, Comm: 180
Round 37/100
  Accuracy: 0.6298, Time: 82.85s, Comm: 180
Round 38/100
  Accuracy: 0.6307, Time: 82.66s, Comm: 180
Round 39/100
  Accuracy: 0.6326, Time: 82.69s, Comm: 180
Round 40/100
  Accuracy: 0.6464, Time: 82.58s, Comm: 180
Round 41/100
  Accuracy: 0.6382, Time: 82.34s, Comm: 180
Round 42/100
  Accuracy: 0.6447, Time: 82.68s, Comm: 180
Round 43/100
  Accuracy: 0.6486, Time: 82.45s, Comm: 180
Round 44/100
  Accuracy: 0.6511, Time: 82.68s, Comm: 180
Round 45/100
  Accuracy: 0.6694, Time: 82.52s, Comm: 180
Round 46/100
  Accuracy: 0.6583, Time: 82.65s, Comm: 180
Round 47/100
  Accuracy: 0.6615, Time: 82.47s, Comm: 180
Round 48/100
  Accuracy: 0.6673, Time: 82.56s, Comm: 180
Round 49/100
  Accuracy: 0.6661, Time: 82.57s, Comm: 180
Round 50/100
  Accuracy: 0.6670, Time: 82.43s, Comm: 180
Round 51/100
  Accuracy: 0.6684, Time: 82.69s, Comm: 180
Round 52/100
  Accuracy: 0.6657, Time: 82.64s, Comm: 180
Round 53/100
  Accuracy: 0.6647, Time: 82.47s, Comm: 180
Round 56/100
  Accuracy: 0.6731, Time: 82.56s, Comm: 180
Round 57/100
  Accuracy: 0.6721, Time: 82.42s, Comm: 180
Round 58/100
  Accuracy: 0.6721, Time: 82.32s, Comm: 180
Round 59/100
  Accuracy: 0.6730, Time: 82.54s, Comm: 180
Round 60/100
  Accuracy: 0.6705, Time: 82.61s, Comm: 180
Round 61/100
  Accuracy: 0.6724, Time: 82.79s, Comm: 180
Round 62/100
  Accuracy: 0.6750, Time: 82.40s, Comm: 180
Round 63/100
  Accuracy: 0.6791, Time: 82.28s, Comm: 180
Round 64/100
  Accuracy: 0.6777, Time: 82.45s, Comm: 180
Round 65/100
  Accuracy: 0.6768, Time: 82.45s, Comm: 180
Round 66/100
  Accuracy: 0.6736, Time: 82.48s, Comm: 180
Round 67/100
  Accuracy: 0.6778, Time: 82.42s, Comm: 180
Round 68/100
  Accuracy: 0.6757, Time: 82.55s, Comm: 180
Round 69/100
  Accuracy: 0.6770, Time: 82.38s, Comm: 180
Round 70/100
  Accuracy: 0.6754, Time: 82.43s, Comm: 180
Round 71/100
  Accuracy: 0.6767, Time: 82.60s, Comm: 180
Round 72/100
  Accuracy: 0.6786, Time: 82.29s, Comm: 180
Round 73/100
  Accuracy: 0.6771, Time: 82.55s, Comm: 180
Round 74/100
  Accuracy: 0.6759, Time: 82.38s, Comm: 180
Round 75/100
  Accuracy: 0.6772, Time: 82.32s, Comm: 180
Round 76/100
  Accuracy: 0.6750, Time: 82.59s, Comm: 180
Round 77/100
  Accuracy: 0.6728, Time: 82.36s, Comm: 180
Round 78/100
  Accuracy: 0.6723, Time: 82.39s, Comm: 180
Round 79/100
  Accuracy: 0.6710, Time: 82.59s, Comm: 180
Round 80/100
  Accuracy: 0.6704, Time: 82.63s, Comm: 180
Round 81/100
  Accuracy: 0.6683, Time: 82.54s, Comm: 180
Round 82/100
  Accuracy: 0.6674, Time: 82.81s, Comm: 180
Round 83/100
  Accuracy: 0.6704, Time: 82.67s, Comm: 180
Round 84/100
  Accuracy: 0.6724, Time: 82.60s, Comm: 180
Round 85/100
  Accuracy: 0.6673, Time: 82.43s, Comm: 180
Round 86/100
  Accuracy: 0.6724, Time: 82.53s, Comm: 180
Round 87/100
  Accuracy: 0.6691, Time: 82.32s, Comm: 180
Round 88/100
  Accuracy: 0.6704, Time: 82.59s, Comm: 180
Round 89/100
  Accuracy: 0.6691, Time: 82.47s, Comm: 180
Round 90/100
  Accuracy: 0.6695, Time: 82.44s, Comm: 180
Round 91/100
  Accuracy: 0.6708, Time: 82.54s, Comm: 180
Round 92/100
  Accuracy: 0.6700, Time: 87.40s, Comm: 180
Round 93/100
  Accuracy: 0.6695, Time: 85.80s, Comm: 180
Round 94/100
  Accuracy: 0.6703, Time: 85.37s, Comm: 180
Round 95/100
  Accuracy: 0.6683, Time: 84.87s, Comm: 180
Round 96/100
  Accuracy: 0.6682, Time: 84.34s, Comm: 180
Round 97/100
  Accuracy: 0.6673, Time: 84.33s, Comm: 180
Round 98/100
  Accuracy: 0.6663, Time: 84.19s, Comm: 180
Round 99/100
  Accuracy: 0.6662, Time: 84.35s, Comm: 180
Round 100/100
  Accuracy: 0.6660, Time: 83.92s, Comm: 180
Client statistics saved to: /FL-agglomerative_clustred/results/client_stats_cifar10_drop-in_20251012_102744.csv
dddddddddd

Results saved to: results/25-10-12-10-28_cifar10_drop-in_50cl_5ep_100r.txt

Visualization saved to: visualizations/cifar10_drop-in_50cl_5ep_100r_25-10-12-10-28.png

============================================================
=== FINAL RESULTS - DROP-IN ===
============================================================
Final Accuracy: 0.6660
Time per/round: 86.99s
Total Communication Cost: 18000



============================================================
Training: AGGLOMERATIVE 
============================================================
JS Distance Stats:
    Min: 0.1358, Max: 0.7707
    Mean: 0.5219, Median: 0.5332
  Edge 0: 6/22 clients : [0, 1, 2, 4, 10, 13, 17, 19, 22, 24, 28, 29, 32, 33, 34, 35, 37, 40, 41, 42, 44, 45]
  Edge 1: 3/10 clients : [3, 5, 6, 11, 14, 15, 23, 26, 27, 31]
  Edge 2: 1/4 clients : [7, 18, 25, 39]
  Edge 3: 1/1 clients : [8]
  Edge 4: 3/11 clients : [9, 16, 20, 21, 36, 38, 43, 46, 47, 48, 49]
  Edge 5: 1/2 clients : [12, 30]
  Total clusters: 6, JS threshold: 0.5
 Train of FL agglomerative...
I0000 00:00:1760251492.187174 3732845 gpu_device.cc:2019] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22162 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:03:00.0, compute capability: 8.9
Round 1/100
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1760251495.977294 3732915 service.cc:152] XLA service 0x7fb5c0015b30 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
I0000 00:00:1760251495.977312 3732915 service.cc:160]   StreamExecutor device (0): NVIDIA GeForce RTX 4090, Compute Capability 8.9
I0000 00:00:1760251496.333300 3732915 cuda_dnn.cc:529] Loaded cuDNN version 90300
I0000 00:00:1760251500.424378 3732915 device_compiler.h:188] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
  Accuracy: 0.1000, Time: 148.02s, Comm: 42
Round 2/100
  Accuracy: 0.1000, Time: 16.39s, Comm: 42
Round 3/100
  Accuracy: 0.1155, Time: 16.37s, Comm: 42
Round 4/100
  Accuracy: 0.1036, Time: 16.41s, Comm: 42
Round 5/100
  Accuracy: 0.1051, Time: 16.39s, Comm: 42
Round 6/100
  Accuracy: 0.1388, Time: 16.38s, Comm: 42
Round 7/100
  Accuracy: 0.1460, Time: 16.44s, Comm: 42
Round 8/100
  Accuracy: 0.2539, Time: 16.50s, Comm: 42
Round 9/100
  Accuracy: 0.3025, Time: 16.47s, Comm: 42
Round 10/100
  Accuracy: 0.3637, Time: 16.51s, Comm: 42
Round 11/100
  Accuracy: 0.3448, Time: 16.39s, Comm: 42
Round 12/100
  Accuracy: 0.4015, Time: 16.47s, Comm: 42
Round 13/100
  Accuracy: 0.4085, Time: 16.47s, Comm: 42
Round 14/100
  Accuracy: 0.4281, Time: 16.36s, Comm: 42
Round 15/100
  Accuracy: 0.4460, Time: 16.45s, Comm: 42
Round 16/100
  Accuracy: 0.4581, Time: 16.48s, Comm: 42
Round 17/100
  Accuracy: 0.4510, Time: 16.44s, Comm: 42
Round 18/100
  Accuracy: 0.4703, Time: 16.48s, Comm: 42
Round 19/100
  Accuracy: 0.4606, Time: 16.58s, Comm: 42
Round 20/100
  Accuracy: 0.4750, Time: 16.41s, Comm: 42
Round 21/100
  Accuracy: 0.4687, Time: 16.50s, Comm: 42
Round 22/100
  Accuracy: 0.4794, Time: 16.42s, Comm: 42
Round 23/100
  Accuracy: 0.4922, Time: 16.42s, Comm: 42
Round 24/100
  Accuracy: 0.4727, Time: 17.12s, Comm: 42
Round 25/100
  Accuracy: 0.4940, Time: 16.62s, Comm: 42
Round 26/100
  Accuracy: 0.4866, Time: 16.52s, Comm: 42
Round 27/100
  Accuracy: 0.4931, Time: 16.59s, Comm: 42
Round 28/100
  Accuracy: 0.4933, Time: 16.60s, Comm: 42
Round 29/100
  Accuracy: 0.4922, Time: 16.55s, Comm: 42
Round 30/100
  Accuracy: 0.4978, Time: 16.55s, Comm: 42
Round 31/100
  Accuracy: 0.4977, Time: 16.53s, Comm: 42
Round 32/100
  Accuracy: 0.4961, Time: 16.53s, Comm: 42
Round 33/100
  Accuracy: 0.5038, Time: 16.54s, Comm: 42
Round 34/100
  Accuracy: 0.4886, Time: 16.55s, Comm: 42
Round 35/100
  Accuracy: 0.4973, Time: 16.55s, Comm: 42
Round 36/100
  Accuracy: 0.5040, Time: 16.56s, Comm: 42
Round 37/100
  Accuracy: 0.5150, Time: 16.61s, Comm: 42
Round 38/100
  Accuracy: 0.5022, Time: 16.58s, Comm: 42
Round 39/100
  Accuracy: 0.5070, Time: 16.55s, Comm: 42
Round 40/100
  Accuracy: 0.5061, Time: 16.55s, Comm: 42
Round 41/100
  Accuracy: 0.5086, Time: 16.56s, Comm: 42
Round 42/100
  Accuracy: 0.5033, Time: 16.56s, Comm: 42
Round 43/100
  Accuracy: 0.5145, Time: 16.55s, Comm: 42
Round 44/100
  Accuracy: 0.5234, Time: 16.54s, Comm: 42
Round 45/100
  Accuracy: 0.5213, Time: 16.52s, Comm: 42
Round 46/100
  Accuracy: 0.5167, Time: 16.53s, Comm: 42
Round 47/100
  Accuracy: 0.5214, Time: 16.59s, Comm: 42
Round 48/100
  Accuracy: 0.5240, Time: 16.55s, Comm: 42
Round 49/100
  Accuracy: 0.5242, Time: 16.54s, Comm: 42
Round 50/100
  Accuracy: 0.5182, Time: 16.52s, Comm: 42
Round 51/100
  Accuracy: 0.5184, Time: 16.50s, Comm: 42
Round 52/100
  Accuracy: 0.5162, Time: 16.48s, Comm: 42
Round 53/100
  Accuracy: 0.5150, Time: 16.59s, Comm: 42
Round 54/100
  Accuracy: 0.5154, Time: 16.54s, Comm: 42
Round 55/100
  Accuracy: 0.5147, Time: 16.50s, Comm: 42
Round 56/100
  Accuracy: 0.5137, Time: 16.59s, Comm: 42
Round 57/100
  Accuracy: 0.5135, Time: 16.45s, Comm: 42
Round 58/100
  Accuracy: 0.5139, Time: 16.53s, Comm: 42
Round 59/100
  Accuracy: 0.5137, Time: 16.55s, Comm: 42
Round 60/100
  Accuracy: 0.5136, Time: 16.43s, Comm: 42
Round 61/100
  Accuracy: 0.5093, Time: 16.60s, Comm: 42
Round 62/100
  Accuracy: 0.5174, Time: 16.65s, Comm: 42
Round 63/100
  Accuracy: 0.5003, Time: 16.52s, Comm: 42
Round 64/100
  Accuracy: 0.5261, Time: 16.51s, Comm: 42
Round 65/100
  Accuracy: 0.5101, Time: 16.61s, Comm: 42
Round 66/100
  Accuracy: 0.5253, Time: 16.49s, Comm: 42
Round 67/100
  Accuracy: 0.5201, Time: 16.54s, Comm: 42
Round 68/100
  Accuracy: 0.5218, Time: 16.57s, Comm: 42
Round 69/100
  Accuracy: 0.5209, Time: 16.51s, Comm: 42
Round 70/100
  Accuracy: 0.5089, Time: 16.46s, Comm: 42
Round 71/100
  Accuracy: 0.5285, Time: 16.40s, Comm: 42
Round 72/100
  Accuracy: 0.5179, Time: 16.53s, Comm: 42
Round 73/100
  Accuracy: 0.5213, Time: 16.47s, Comm: 42
Round 74/100
  Accuracy: 0.5191, Time: 16.61s, Comm: 42
Round 75/100
  Accuracy: 0.5216, Time: 16.49s, Comm: 42
Round 76/100
  Accuracy: 0.5178, Time: 16.47s, Comm: 42
Round 77/100
  Accuracy: 0.5175, Time: 16.58s, Comm: 42
Round 78/100
  Accuracy: 0.5204, Time: 16.53s, Comm: 42
Round 79/100
  Accuracy: 0.5209, Time: 16.37s, Comm: 42
Round 80/100
  Accuracy: 0.5203, Time: 16.57s, Comm: 42
Round 81/100
  Accuracy: 0.5187, Time: 16.56s, Comm: 42
Round 82/100
  Accuracy: 0.5182, Time: 16.56s, Comm: 42
Round 83/100
  Accuracy: 0.5183, Time: 16.58s, Comm: 42
Round 84/100
  Accuracy: 0.5172, Time: 16.56s, Comm: 42
Round 85/100
  Accuracy: 0.5174, Time: 16.54s, Comm: 42
Round 86/100
  Accuracy: 0.5172, Time: 16.50s, Comm: 42
Round 87/100
  Accuracy: 0.5166, Time: 16.60s, Comm: 42
Round 88/100
  Accuracy: 0.5167, Time: 16.49s, Comm: 42
Round 89/100
  Accuracy: 0.5166, Time: 16.57s, Comm: 42
Round 90/100
  Accuracy: 0.5165, Time: 16.61s, Comm: 42
Round 91/100
  Accuracy: 0.5166, Time: 16.44s, Comm: 42
Round 92/100
  Accuracy: 0.5168, Time: 16.51s, Comm: 42
Round 93/100
  Accuracy: 0.5003, Time: 16.61s, Comm: 42
Round 94/100
  Accuracy: 0.5148, Time: 16.47s, Comm: 42
Round 95/100
  Accuracy: 0.5109, Time: 16.53s, Comm: 42
Round 96/100
  Accuracy: 0.5189, Time: 16.41s, Comm: 42
Round 97/100
  Accuracy: 0.5177, Time: 16.52s, Comm: 42
Round 98/100
  Accuracy: 0.5165, Time: 16.49s, Comm: 42
Round 99/100
  Accuracy: 0.5159, Time: 16.58s, Comm: 42
Round 100/100
  Accuracy: 0.5160, Time: 16.60s, Comm: 42
Client statistics saved to: /FL-agglomerative_clustred/results/client_stats_cifar10_agglomerative_20251012_071437.csv
dddddddddd

Results saved to: results/25-10-12-07-14_cifar10_agglomerative_50cl_5ep_100r.txt

Visualization saved to: visualizations/cifar10_agglomerative_50cl_5ep_100r_25-10-12-07-14.png

============================================================
=== FINAL RESULTS - AGGLOMERATIVE ===
============================================================
Final Accuracy: 0.5160
Time per/round: 17.84s
Total Communication Cost: 4200